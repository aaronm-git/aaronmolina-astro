---
import type { IconType } from 'react-icons';
import { getIcon, FaArrowRight } from '@/utils/icons';

type HeadingLevel = 2 | 3 | 4;

interface Props {
  /** Section title */
  title: string;
  /** Icon name (uses getIcon to resolve) */
  icon?: string;
  /** Direct icon component */
  iconComponent?: IconType;
  /** "View all" link href */
  viewAllHref?: string;
  /** "View all" link label */
  viewAllLabel?: string;
  /** Hide "View all" link on mobile */
  hideViewAllOnMobile?: boolean;
  /** Heading level (h2, h3, h4) */
  level?: HeadingLevel;
  /** Additional CSS classes */
  class?: string;
}

const {
  title,
  icon,
  iconComponent,
  viewAllHref,
  viewAllLabel = 'View All',
  hideViewAllOnMobile = false,
  level = 2,
  class: className = '',
} = Astro.props;

// Resolve icon
const IconComponent = iconComponent || (icon ? getIcon(icon) : null);

// Heading element tag
const HeadingTag = `h${level}` as const;

// Size classes based on level
const headingSizeClasses: Record<HeadingLevel, string> = {
  2: 'text-2xl md:text-3xl',
  3: 'text-xl md:text-2xl',
  4: 'text-lg md:text-xl',
};

const combinedClasses = [
  'mb-8 flex items-center justify-between',
  className,
].filter(Boolean).join(' ');

const viewAllClasses = [
  'text-secondary hover:text-secondary-hover group flex items-center gap-1 font-medium',
  hideViewAllOnMobile ? 'hidden md:flex' : '',
].filter(Boolean).join(' ');
---

<div class={combinedClasses}>
  <HeadingTag class={`text-foreground flex items-center gap-3 font-bold ${headingSizeClasses[level]}`}>
    {IconComponent && (
      <IconComponent className="text-secondary icon-base" />
    )}
    {title}
  </HeadingTag>

  {viewAllHref && (
    <a href={viewAllHref} class={viewAllClasses}>
      {viewAllLabel}
      <FaArrowRight className="icon-sm transition-transform group-hover:translate-x-1" />
    </a>
  )}
</div>
