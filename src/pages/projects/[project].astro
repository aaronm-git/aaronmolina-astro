---
/**
 * Project Detail Page
 * Uses ProjectDetailTemplate for consistent structure
 */
import { ProjectDetailTemplate } from '@/templates';
import { getCollection, render } from 'astro:content';
import { createTechMap, objectToTechMap } from '@/utils/tech-lookup';

export async function getStaticPaths() {
  const projects = await getCollection('projects');
  const technologies = await getCollection('technologies');
  const techMap = createTechMap(technologies);

  return projects.map(p => ({
    params: { project: p.data.slug },
    props: { project: p, techMapObj: Object.fromEntries(techMap) },
  }));
}

const { project, techMapObj } = Astro.props;
const { Content } = await render(project);
const techMap = objectToTechMap(techMapObj);
---

<ProjectDetailTemplate project={project} techMap={techMap}>
  <Content />
</ProjectDetailTemplate>
