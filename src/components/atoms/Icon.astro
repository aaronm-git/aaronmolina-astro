---
import type { IconType } from 'react-icons';
import { getNavIcon, getSocialIcon, getCategoryIcon, getUIIcon, getIcon } from '@/lib/icons';
import { cn } from '@/lib/cn';

type IconSize = 'xs' | 'sm' | 'base' | 'lg' | 'xl' | '2xl';

interface Props {
  /** Icon identifier - can be nav key, social platform, category, or UI icon name */
  name?: string;
  /** Icon type to help narrow down the search */
  type?: 'nav' | 'social' | 'category' | 'ui' | 'auto';
  /** Size of the icon */
  size?: IconSize;
  /** Additional CSS classes */
  class?: string;
  /** Direct icon component (use instead of name for custom icons) */
  icon?: IconType;
  /** Aria label for accessibility */
  label?: string;
  /** Color class */
  color?: 'primary' | 'secondary' | 'muted' | 'foreground' | 'success' | 'warning' | 'error' | 'inherit';
}

const {
  name,
  type = 'auto',
  size = 'base',
  class: className = '',
  icon: directIcon,
  label,
  color = 'inherit',
} = Astro.props;

// Get icon component
let IconComponent: IconType | null = directIcon || null;

if (!IconComponent && name) {
  switch (type) {
    case 'nav':
      IconComponent = getNavIcon(name);
      break;
    case 'social':
      IconComponent = getSocialIcon(name);
      break;
    case 'category':
      IconComponent = getCategoryIcon(name);
      break;
    case 'ui':
      IconComponent = getUIIcon(name);
      break;
    case 'auto':
    default:
      IconComponent = getIcon(name);
      break;
  }
}

// Size classes
const sizeClasses: Record<IconSize, string> = {
  xs: 'w-3 h-3',
  sm: 'w-4 h-4',
  base: 'w-5 h-5',
  lg: 'w-6 h-6',
  xl: 'w-8 h-8',
  '2xl': 'w-10 h-10',
};

// Color classes
const colorClasses: Record<string, string> = {
  primary: 'text-primary',
  secondary: 'text-secondary',
  muted: 'text-foreground-muted',
  foreground: 'text-foreground',
  success: 'text-green-500',
  warning: 'text-yellow-500',
  error: 'text-red-500',
  inherit: '',
};

const combinedClass = cn(
  sizeClasses[size],
  colorClasses[color],
  className,
);
---

{IconComponent && (
  <IconComponent
    className={combinedClass}
    aria-hidden={!label}
    aria-label={label}
  />
)}
