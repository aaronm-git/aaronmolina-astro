---
import MainLayout from '@/layouts/main-layout.astro';

// You can set your Formspree endpoint here or use environment variables
// const FORMSPREE_ENDPOINT = import.meta.env.FORMSPREE_ENDPOINT || 'https://formspree.io/f/YOUR_FORM_ID';
const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xaydzyqa'; // Replace with your actual form ID
---

<MainLayout>
  <div class="mx-auto max-w-4xl p-8">
    <!-- Header -->
    <header class="mb-12 text-center">
      <h1 class="text-primary-900 mb-4 text-5xl font-bold">Get In Touch</h1>
      <p class="text-primary-700 mx-auto max-w-2xl text-lg">
        Ready to start your next project? I'd love to hear about your ideas and discuss how we can work together to bring them to life.
      </p>
    </header>

    <!-- Contact Form -->
    <div class="mb-16 grid gap-12 lg:grid-cols-2">
      <!-- Form -->
      <div class="border-primary-100 rounded-lg border bg-white p-8 shadow-md">
        <h2 class="text-primary-900 mb-6 text-2xl font-bold">Send a Message</h2>

        <form id="contact-form" action={FORMSPREE_ENDPOINT} method="POST" class="space-y-6">
          <div class="grid gap-6 md:grid-cols-2">
            <div>
              <label for="name" class="text-primary-900 mb-2 block text-sm font-medium">Full Name</label>
              <input
                type="text"
                id="name"
                name="name"
                required
                class="border-primary-300 focus:border-secondary-500 focus:ring-secondary-500 w-full rounded-md border px-3 py-2 focus:ring-2 focus:outline-none"
                placeholder="Your name"
              />
            </div>

            <div>
              <label for="email" class="text-primary-900 mb-2 block text-sm font-medium">Email Address</label>
              <input
                type="email"
                id="email"
                name="email"
                required
                class="border-primary-300 focus:border-secondary-500 focus:ring-secondary-500 w-full rounded-md border px-3 py-2 focus:ring-2 focus:outline-none"
                placeholder="your@email.com"
              />
            </div>
          </div>

          <div>
            <label for="company" class="text-primary-900 mb-2 block text-sm font-medium">Company (Optional)</label>
            <input
              type="text"
              id="company"
              name="company"
              class="border-primary-300 focus:border-secondary-500 focus:ring-secondary-500 w-full rounded-md border px-3 py-2 focus:ring-2 focus:outline-none"
              placeholder="Your company"
            />
          </div>

          <div>
            <label for="project-type" class="text-primary-900 mb-2 block text-sm font-medium">Project Type</label>
            <select
              id="project-type"
              name="project-type"
              class="border-primary-300 focus:border-secondary-500 focus:ring-secondary-500 w-full rounded-md border px-3 py-2 focus:ring-2 focus:outline-none"
            >
              <option value="">Select a project type</option>
              <option value="frontend">Frontend Development</option>
              <option value="fullstack">Full-Stack Application</option>
              <option value="website">Website Development</option>
              <option value="consultation">Technical Consultation</option>
              <option value="optimization">Performance Optimization</option>
              <option value="other">Other</option>
            </select>
          </div>

          <div>
            <label for="budget" class="text-primary-900 mb-2 block text-sm font-medium">Budget Range (Optional)</label>
            <select
              id="budget"
              name="budget"
              class="border-primary-300 focus:border-secondary-500 focus:ring-secondary-500 w-full rounded-md border px-3 py-2 focus:ring-2 focus:outline-none"
            >
              <option value="">Select budget range</option>
              <option value="under-5k">Under $5,000</option>
              <option value="5k-15k">$5,000 - $15,000</option>
              <option value="15k-30k">$15,000 - $30,000</option>
              <option value="30k-plus">$30,000+</option>
              <option value="discuss">Let's discuss</option>
            </select>
          </div>

          <div>
            <label for="message" class="text-primary-900 mb-2 block text-sm font-medium">Project Details</label>
            <textarea
              id="message"
              name="message"
              rows="6"
              required
              class="border-primary-300 focus:border-secondary-500 focus:ring-secondary-500 w-full rounded-md border px-3 py-2 focus:ring-2 focus:outline-none"
              placeholder="Tell me about your project, timeline, and any specific requirements..."></textarea>
          </div>

          <!-- Hidden fields for Formspree -->
          <input type="hidden" name="_subject" value="New Contact Form Submission" />
          <input type="hidden" name="_cc" value="your-email@example.com" />

          <button
            type="submit"
            id="submit-button"
            class="bg-primary-600 hover:bg-primary-700 focus:ring-primary-500 flex w-full items-center justify-center gap-2 rounded-md px-4 py-3 font-medium text-white transition-colors focus:ring-2 focus:ring-offset-2 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50"
          >
            <span id="submit-text">Send Message</span>
            <div id="loading-spinner" class="hidden">
              <svg class="h-5 w-5 animate-spin text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                ></path>
              </svg>
            </div>
          </button>
        </form>
      </div>

      <!-- Contact Info -->
      <div class="space-y-8">
        <div class="border-primary-100 rounded-lg border bg-white p-6 shadow-md">
          <h3 class="text-primary-900 mb-4 text-xl font-bold">Why Work With Me?</h3>
          <div class="space-y-4">
            <div class="flex items-start gap-3">
              <i data-feather="briefcase" class="text-secondary-600 mt-1 h-5 w-5 flex-shrink-0"></i>
              <div>
                <h4 class="text-primary-900 font-medium">Experience</h4>
                <p class="text-primary-600 text-sm">I've been in the industry for over 10 years and have worked with some of the biggest brands in the world</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i data-feather="zap" class="text-secondary-600 mt-1 h-5 w-5 flex-shrink-0"></i>
              <div>
                <h4 class="text-primary-900 font-medium">Fast & Efficient</h4>
                <p class="text-primary-600 text-sm">Quick turnaround times without compromising quality</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i data-feather="users" class="text-secondary-600 mt-1 h-5 w-5 flex-shrink-0"></i>
              <div>
                <h4 class="text-primary-900 font-medium">Collaborative Approach</h4>
                <p class="text-primary-600 text-sm">Regular communication and feedback throughout the project</p>
              </div>
            </div>
            <div class="flex items-start gap-3">
              <i data-feather="shield" class="text-secondary-600 mt-1 h-5 w-5 flex-shrink-0"></i>
              <div>
                <h4 class="text-primary-900 font-medium">Quality Assurance</h4>
                <p class="text-primary-600 text-sm">Clean, tested code with focus on performance and accessibility</p>
              </div>
            </div>
          </div>
        </div>

        <div class="border-primary-100 rounded-lg border bg-white p-6 shadow-md">
          <h3 class="text-primary-900 mb-4 text-xl font-bold">Response Time</h3>
          <div class="space-y-3">
            <div class="flex items-center gap-2">
              <span data-feather="clock" class="text-secondary-600 h-4 w-4"></span>
              <span class="text-primary-700 text-sm">I typically respond within 24 hours</span>
            </div>
            <div class="flex items-center gap-2">
              <span data-feather="calendar" class="text-secondary-600 h-4 w-4"></span>
              <span class="text-primary-700 text-sm">Free consultation calls available</span>
            </div>
            <div class="flex items-center gap-2">
              <span data-feather="globe" class="text-secondary-600 h-4 w-4"></span>
              <span class="text-primary-700 text-sm">Available for remote projects worldwide</span>
            </div>
          </div>
        </div>

        <div class="bg-secondary-50 border-secondary-200 rounded-lg border p-6">
          <h3 class="text-primary-900 mb-3 text-lg font-bold">Ready to Start?</h3>
          <p class="text-primary-700 mb-4 text-sm">Looking for something specific? Check out my recent work and technical expertise.</p>
          <div class="flex gap-3">
            <a href="/projects" class="text-secondary-600 hover:text-secondary-800 border-secondary-600 flex items-center gap-1 rounded-lg border px-4 py-2 text-sm font-medium">
              <span data-feather="briefcase" class="h-4 w-4"></span>
              View Projects
            </a>
            <a href="/experience" class="text-secondary-600 hover:text-secondary-800 border-secondary-600 flex items-center gap-1 rounded-lg border px-4 py-2 text-sm font-medium">
              <span data-feather="user" class="h-4 w-4"></span>
              My Experience
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Social Media Section -->
    <section class="bg-primary-50 border-primary-100 rounded-lg border p-8 text-center">
      <h2 class="text-primary-900 mb-4 text-3xl font-bold">Connect With Me</h2>
      <p class="text-primary-700 mx-auto mb-6 max-w-2xl">Prefer social media? Find me on these platforms or check out my latest projects and articles.</p>
      <div class="flex justify-center gap-6">
        <a
          href="https://github.com/aaronm-git"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 rounded-lg bg-gray-800 px-6 py-3 font-medium text-white transition-colors hover:bg-gray-900"
        >
          <span data-feather="github"></span>
          GitHub
        </a>
        <a
          href="https://www.linkedin.com/in/aaronmolinag"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-3 font-medium text-white transition-colors hover:bg-blue-700"
        >
          <span data-feather="linkedin"></span>
          LinkedIn
        </a>
        <a
          href="https://www.instagram.com/chillsloth09"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-2 rounded-lg bg-pink-600 px-6 py-3 font-medium text-white transition-colors hover:bg-pink-700"
        >
          <span data-feather="instagram"></span>
          Instagram
        </a>
      </div>
    </section>
  </div>

  <!-- Thank You Modal -->
  <div id="thank-you-modal" class="bg-opacity-50 fixed inset-0 z-50 hidden items-center justify-center bg-black p-4">
    <div class="animate-fade-in w-full max-w-md rounded-lg bg-white p-8 text-center">
      <div class="mb-6">
        <div class="mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-green-100">
          <svg class="h-8 w-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
          </svg>
        </div>
        <h3 class="text-primary-900 mb-2 text-2xl font-bold">Thank You!</h3>
        <p class="text-primary-700 text-base">Your message has been sent successfully. I'll get back to you within 24 hours.</p>
      </div>
      <div class="space-y-3">
        <a href="/" class="bg-primary-600 hover:bg-primary-700 inline-block w-full rounded-lg px-6 py-3 font-medium text-white transition-colors"> Back to Homepage </a>
        <button id="close-modal" class="text-primary-600 hover:text-primary-700 w-full rounded-lg px-4 py-2 font-medium transition-colors"> Close </button>
      </div>
    </div>
  </div>
</MainLayout>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const submitButton = document.getElementById('submit-button') as HTMLButtonElement;
    const submitText = document.getElementById('submit-text') as HTMLSpanElement;
    const loadingSpinner = document.getElementById('loading-spinner') as HTMLDivElement;
    const thankYouModal = document.getElementById('thank-you-modal') as HTMLDivElement;
    const closeModalButton = document.getElementById('close-modal') as HTMLButtonElement;

    if (!form || !submitButton || !submitText || !loadingSpinner || !thankYouModal || !closeModalButton) {
      console.error('Required elements not found');
      return;
    }

    // Handle form submission
    form.addEventListener('submit', async function (e) {
      e.preventDefault();

      // Show loading state
      submitButton.disabled = true;
      submitText.textContent = 'Sending...';
      loadingSpinner.classList.remove('hidden');

      try {
        const formData = new FormData(form);
        const response = await fetch(form.action, {
          method: 'POST',
          body: formData,
          headers: {
            Accept: 'application/json',
          },
        });

        if (response.ok) {
          // Success - show modal
          thankYouModal.classList.remove('hidden');
          thankYouModal.classList.add('flex');
          form.reset();
        } else {
          // Error handling
          throw new Error('Form submission failed');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('There was an error sending your message. Please try again.');
      } finally {
        // Reset button state
        submitButton.disabled = false;
        submitText.textContent = 'Send Message';
        loadingSpinner.classList.add('hidden');
      }
    });

    // Close modal handlers
    closeModalButton.addEventListener('click', function () {
      thankYouModal.classList.add('hidden');
      thankYouModal.classList.remove('flex');
    });

    // Close modal when clicking outside
    thankYouModal.addEventListener('click', function (e) {
      if (e.target === thankYouModal) {
        thankYouModal.classList.add('hidden');
        thankYouModal.classList.remove('flex');
      }
    });

    // Close modal with Escape key
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape' && !thankYouModal.classList.contains('hidden')) {
        thankYouModal.classList.add('hidden');
        thankYouModal.classList.remove('flex');
      }
    });
  });
</script>

<style>
  @keyframes fade-in {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .animate-fade-in {
    animation: fade-in 0.2s ease-out;
  }
</style>
