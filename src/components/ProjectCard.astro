---
import { Image } from "astro:assets";

interface Props {
  project: {
    data: {
      title: string;
      slug?: string;
      description?: string;
      tags: string[];
      featuredImage?: string;
      link?: string;
      completedOn?: Date;
      pinned?: boolean;
    };
  };
  showCompletedDate?: boolean;
}

const { project, showCompletedDate = false } = Astro.props;
---

<article class="bg-white rounded-lg shadow-lg border border-primary-100 overflow-hidden hover:shadow-xl transition-shadow flex flex-col">
  <div class="aspect-video bg-primary-50 overflow-hidden">
    {
      project.data.featuredImage ? (
        <Image src={project.data.featuredImage} alt={project.data.title} class="w-full h-full object-cover" loading="eager" width={600} height={400} />
      ) : (
        <div class="w-full h-full bg-primary-100 flex items-center justify-center">
          <span class="text-primary-500 flex items-center gap-2">
            No Image <i data-feather="image" class="w-4 h-4" />
          </span>
        </div>
      )
    }
  </div>

  <div class="p-6 flex-1 flex flex-col">
    {
      project.data.pinned && (
        <div class="flex items-center mb-2">
          <span class="px-2 py-1 bg-secondary-100 text-secondary-800 text-xs font-semibold rounded-full">Featured</span>
        </div>
      )
    }

    <h3 class="text-xl font-semibold text-primary-900 mb-3">
      {
        project.data.link ? (
          <a href={`/projects/${project.data.slug}`} class="hover:text-secondary-600 transition-colors">
            {project.data.title}
          </a>
        ) : (
          project.data.title
        )
      }
    </h3>

    {
      showCompletedDate && project.data.completedOn && (
        <div class="text-sm text-primary-600 mb-3">
          Completed:{" "}
          {project.data.completedOn.toLocaleDateString("en-US", {
            year: "numeric",
            month: "long",
          })}
        </div>
      )
    }

    {project.data.description && <p class="text-primary-700 mb-4 text-sm leading-relaxed">{project.data.description}</p>}

    <div class="flex flex-wrap gap-2 mb-4">
      {project.data.tags.slice(0, 3).map((tag) => <span class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-xs font-medium">{tag}</span>)}
    </div>

    <div class="flex justify-between items-center mt-auto">
      <a href={`/projects/${project.data.slug}`} class="text-secondary-600 hover:text-secondary-800 font-medium flex items-center gap-1">
        Learn more <span data-feather="arrow-right" class="w-4 h-4"></span>
      </a>
      {
        project.data.link && (
          <a href={project.data.link} class="text-primary-600 hover:text-primary-800 flex items-center gap-1" target="_blank" rel="noopener noreferrer">
            <span data-feather="external-link" class="w-4 h-4" />
          </a>
        )
      }
    </div>
  </div>
</article>
