---
import { getSocialIcon } from '@/utils/icons';
import type { IconType } from 'react-icons';

type LinkVariant = 'icon-only' | 'with-label' | 'button';
type LinkSize = 'sm' | 'base' | 'lg';

interface SocialLink {
  platform: string;
  url: string;
  label?: string;
  ariaLabel?: string;
}

interface Props {
  /** Array of social links */
  links: SocialLink[];
  /** Display variant */
  variant?: LinkVariant;
  /** Size of icons/buttons */
  size?: LinkSize;
  /** Additional CSS classes for the container */
  class?: string;
}

const {
  links,
  variant = 'icon-only',
  size = 'base',
  class: className = '',
} = Astro.props;

// Size classes
const iconSizeClasses: Record<LinkSize, string> = {
  sm: 'icon-xs',
  base: 'icon-sm',
  lg: 'icon-base',
};

const buttonPaddingClasses: Record<LinkSize, string> = {
  sm: 'px-4 py-2 text-sm',
  base: 'px-6 py-3 text-base',
  lg: 'px-8 py-4 text-lg',
};

const iconOnlyPaddingClasses: Record<LinkSize, string> = {
  sm: 'p-1.5',
  base: 'p-2',
  lg: 'p-3',
};

// Base container classes
const containerClasses = [
  'flex items-center',
  variant === 'button' ? 'flex-wrap gap-4' : 'space-x-4',
  className,
].filter(Boolean).join(' ');

// Build link classes based on variant
function getLinkClasses(v: LinkVariant): string {
  switch (v) {
    case 'icon-only':
      return `text-foreground-muted hover:text-secondary ${iconOnlyPaddingClasses[size]} rounded-md hover:bg-muted transition-colors`;
    case 'with-label':
      return 'text-foreground-muted hover:text-secondary flex items-center gap-2 transition-colors';
    case 'button':
      return `bg-primary hover:bg-primary-hover text-on-primary inline-flex items-center gap-2 rounded-lg font-medium transition-colors ${buttonPaddingClasses[size]}`;
    default:
      return '';
  }
}
---

<div class={containerClasses}>
  {links.map((link) => {
    const Icon = getSocialIcon(link.platform);
    if (!Icon) return null;

    return (
      <a
        href={link.url}
        target="_blank"
        rel="noopener noreferrer"
        class={getLinkClasses(variant)}
        aria-label={link.ariaLabel || link.label || link.platform}
      >
        <Icon className={iconSizeClasses[size]} />
        {(variant === 'with-label' || variant === 'button') && link.label && (
          <span>{link.label}</span>
        )}
      </a>
    );
  })}
</div>
