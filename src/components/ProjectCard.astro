---
import { Image } from 'astro:assets';
import { FaImage, FaArrowRight, FaExternalLinkAlt } from 'react-icons/fa';

interface Props {
  project: {
    data: {
      title: string;
      slug?: string;
      description?: string;
      tags: string[];
      featuredImage?: string;
      link?: string;
      completedOn?: Date;
      pinned?: boolean;
    };
  };
  showCompletedDate?: boolean;
}

const { project, showCompletedDate = false } = Astro.props;
---

<article
  class="animate-card border-primary-100 dark:border-primary-800 dark:bg-primary-900 flex flex-col overflow-hidden rounded-lg border bg-white shadow-lg transition-shadow hover:shadow-xl"
>
  <div class="bg-primary-50 dark:bg-primary-800 relative aspect-video overflow-hidden">
    {
      project.data.featuredImage ? (
        <Image src={project.data.featuredImage} alt={project.data.title} class="h-full w-full object-cover" loading="eager" width={600} height={400} />
      ) : (
        <div class="bg-primary-100 dark:bg-primary-700 flex h-full w-full items-center justify-center">
          <span class="text-primary-500 dark:text-primary-400 flex items-center gap-2">
            No Image <FaImage className="h-4 w-4" />
          </span>
        </div>
      )
    }
    {
      project.data.pinned && (
        <div class="absolute right-0 bottom-0 z-10 flex w-full">
          <span class="bg-secondary-100 dark:bg-secondary-800 text-secondary-800 dark:text-secondary-200 w-full px-2 py-1 text-center text-xs font-semibold">Featured</span>
        </div>
      )
    }
  </div>

  <div class="flex flex-1 flex-col p-6">
    <h3 class="text-primary-900 dark:text-primary-100 mb-3 text-xl font-semibold">
      {
        project.data.link ? (
          <a href={`/projects/${project.data.slug}`} class="hover:text-secondary-600 dark:hover:text-secondary-400 transition-colors">
            {project.data.title}
          </a>
        ) : (
          project.data.title
        )
      }
    </h3>

    {
      showCompletedDate && project.data.completedOn && (
        <div class="text-primary-600 dark:text-primary-400 mb-3 text-sm">
          Completed:{' '}
          {project.data.completedOn.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
          })}
        </div>
      )
    }

    {project.data.description && <p class="text-primary-700 dark:text-primary-300 mb-4 text-sm leading-relaxed">{project.data.description}</p>}

    <div class="mb-4 flex flex-wrap gap-2">
      {
        project.data.tags.slice(0, 3).map(tagSlug => {
          return <span class="bg-secondary-50 dark:bg-secondary-900 text-secondary-700 dark:text-secondary-300 rounded-full px-3 py-1 text-xs font-medium">{tagSlug}</span>;
        })
      }
    </div>

    <div class="border-primary-100 dark:border-primary-700 mt-auto flex items-center justify-between border-t pt-4">
      <a
        href={`/projects/${project.data.slug}`}
        class="text-secondary-600 dark:text-secondary-400 hover:text-secondary-800 dark:hover:text-secondary-500 flex items-center gap-1 font-medium"
      >
        Learn more <FaArrowRight className="h-4 w-4" />
      </a>
      {
        project.data.link && (
          <a
            href={project.data.link}
            class="text-primary-600 dark:text-primary-400 hover:text-primary-800 dark:hover:text-primary-300 flex items-center gap-1"
            target="_blank"
            rel="noopener noreferrer"
          >
            View project <FaExternalLinkAlt className="h-4 w-4" />
          </a>
        )
      }
    </div>
  </div>
</article>
