---
import Avatar from '@/components/atoms/Avatar.astro';
import { cn } from '@/lib/cn';
import type { ImageMetadata } from 'astro';

type MediaAlign = 'top' | 'center' | 'bottom';
type MediaGap = 'sm' | 'base' | 'lg';

interface Props {
  /** Media image source */
  src?: ImageMetadata | string;
  /** Alt text for image */
  alt?: string;
  /** Fallback text (initials) */
  fallback?: string;
  /** Media alignment */
  align?: MediaAlign;
  /** Gap between media and content */
  gap?: MediaGap;
  /** Reverse layout (content left, media right) */
  reverse?: boolean;
  /** Avatar size */
  avatarSize?: 'xs' | 'sm' | 'base' | 'lg' | 'xl' | '2xl';
  /** Avatar rounded style */
  avatarRounded?: 'none' | 'sm' | 'base' | 'lg' | 'full';
  /** Additional CSS classes */
  class?: string;
}

const {
  src,
  alt = '',
  fallback,
  align = 'top',
  gap = 'base',
  reverse = false,
  avatarSize = 'base',
  avatarRounded = 'full',
  class: className = '',
} = Astro.props;

// Alignment classes
const alignClasses: Record<MediaAlign, string> = {
  top: 'items-start',
  center: 'items-center',
  bottom: 'items-end',
};

// Gap classes
const gapClasses: Record<MediaGap, string> = {
  sm: 'gap-2',
  base: 'gap-4',
  lg: 'gap-6',
};

const combinedClasses = cn(
  'flex',
  alignClasses[align],
  gapClasses[gap],
  reverse && 'flex-row-reverse',
  className,
);
---

<div class={combinedClasses}>
  <div class="flex-shrink-0">
    <slot name="media">
      <Avatar
        src={src}
        alt={alt}
        fallback={fallback}
        size={avatarSize}
        rounded={avatarRounded}
      />
    </slot>
  </div>
  <div class="flex-1 min-w-0">
    <slot />
  </div>
</div>
