---
import { cn } from '@/lib/cn';

type TextElement = 'p' | 'span' | 'div' | 'label' | 'time';
type TextSize = 'xs' | 'sm' | 'base' | 'lg' | 'xl' | '2xl';
type TextWeight = 'normal' | 'medium' | 'semibold' | 'bold';
type TextColor = 'foreground' | 'muted' | 'primary' | 'secondary' | 'success' | 'warning' | 'error' | 'inherit';
type TextLeading = 'none' | 'tight' | 'snug' | 'normal' | 'relaxed' | 'loose';

interface Props {
  /** HTML element to render */
  as?: TextElement;
  /** Text size */
  size?: TextSize;
  /** Font weight */
  weight?: TextWeight;
  /** Text color */
  color?: TextColor;
  /** Line height */
  leading?: TextLeading;
  /** Text wrap balance */
  balance?: boolean;
  /** Truncate with ellipsis */
  truncate?: boolean;
  /** Line clamp (number of lines) */
  clamp?: 1 | 2 | 3 | 4 | 5 | 6;
  /** Additional CSS classes */
  class?: string;
}

const {
  as: Element = 'p',
  size = 'base',
  weight = 'normal',
  color = 'foreground',
  leading = 'normal',
  balance = false,
  truncate = false,
  clamp,
  class: className = '',
} = Astro.props as Props;

// Size classes
const sizeClasses: Record<TextSize, string> = {
  xs: 'text-xs',
  sm: 'text-sm',
  base: 'text-base',
  lg: 'text-lg',
  xl: 'text-xl',
  '2xl': 'text-2xl',
};

// Weight classes
const weightClasses: Record<TextWeight, string> = {
  normal: 'font-normal',
  medium: 'font-medium',
  semibold: 'font-semibold',
  bold: 'font-bold',
};

// Color classes
const colorClasses: Record<TextColor, string> = {
  foreground: 'text-foreground',
  muted: 'text-foreground-muted',
  primary: 'text-primary',
  secondary: 'text-secondary',
  success: 'text-green-500',
  warning: 'text-yellow-500',
  error: 'text-red-500',
  inherit: '',
};

// Leading classes
const leadingClasses: Record<TextLeading, string> = {
  none: 'leading-none',
  tight: 'leading-tight',
  snug: 'leading-snug',
  normal: 'leading-normal',
  relaxed: 'leading-relaxed',
  loose: 'leading-loose',
};

// Line clamp classes
const clampClasses: Record<number, string> = {
  1: 'line-clamp-1',
  2: 'line-clamp-2',
  3: 'line-clamp-3',
  4: 'line-clamp-4',
  5: 'line-clamp-5',
  6: 'line-clamp-6',
};

const combinedClasses = cn(
  sizeClasses[size],
  weightClasses[weight],
  colorClasses[color],
  leadingClasses[leading],
  balance && 'text-balance',
  truncate && 'truncate',
  clamp && clampClasses[clamp],
  className,
);
---

<Element class={combinedClasses}>
  <slot />
</Element>

<style>
  .text-balance {
    text-wrap: balance;
  }
</style>
