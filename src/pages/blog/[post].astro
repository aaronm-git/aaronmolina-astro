---
import MainLayout from "@/layouts/main-layout.astro";
import { getCollection, render } from "astro:content";

export async function getStaticPaths() {
	const posts = await getCollection("blog");
	return posts.map(p => ({
		params: { post: p.data.slug },
		props: { post: p },
	}));
}

const { post } = Astro.props;
const { Content } = await render(post);
---

<MainLayout title={post.data.title} description={post.data.description}>
	<article class="max-w-4xl mx-auto px-4 py-8">
		<!-- Post Header -->
		<header class="mb-8">
			<h1 class="text-4xl font-bold text-primary-900 mb-4">
				{post.data.title}
			</h1>

			<div class="flex items-center text-primary-600 mb-4">
				<time datetime={post.data.date.toISOString()}>
					{
						post.data.date.toLocaleDateString("en-US", {
							year: "numeric",
							month: "long",
							day: "numeric",
						})
					}
				</time>
			</div>

			{post.data.description && <p class="text-xl text-primary-700 mb-6">{post.data.description}</p>}

			{
				post.data.tags && post.data.tags.length > 0 && (
					<div class="flex flex-wrap gap-2 mb-6">
						{post.data.tags.map(tag => (
							<span class="px-3 py-1 bg-secondary-100 text-secondary-800 text-sm rounded-full">{tag}</span>
						))}
					</div>
				)
			}
		</header>

		<!-- Post Content -->
		<div class="typography max-w-none">
			<Content />
		</div>

		<!-- Post Footer -->
		<footer class="mt-12 pt-8 border-t border-primary-200">
			<div class="flex justify-between items-center">
				<a href="/blog" class="text-secondary-600 hover:text-secondary-800"> ‚Üê Back to Blog </a>
				<div class="text-sm text-primary-500">
					Last updated: {post.data.date.toLocaleDateString()}
				</div>
			</div>
		</footer>
	</article>
</MainLayout>
