---
/**
 * Blog Post Page
 * Uses BlogPostTemplate for consistent structure
 */
import { BlogPostTemplate } from '@/templates';
import { getCollection, render } from 'astro:content';
import { createTechMap, objectToTechMap } from '@/utils/tech-lookup';

export async function getStaticPaths() {
  const posts = await getCollection('blog');
  const technologies = await getCollection('technologies');
  const techMap = createTechMap(technologies);

  return posts.map(p => ({
    params: { post: p.data.slug },
    props: { post: p, techMapObj: Object.fromEntries(techMap) },
  }));
}

const { post, techMapObj } = Astro.props;
const { Content } = await render(post);
const techMap = objectToTechMap(techMapObj);
---

<BlogPostTemplate post={post} techMap={techMap}>
  <Content />
</BlogPostTemplate>
